# QR Code Management System

A MERN stack application with QR code generation, storage, and management capabilities.

## Features

### Authentication
- User registration and login
- Role-based access (Admin/User)
- Session management

### QR Code Management
- **Admin Dashboard**: Generate, edit, and delete QR codes
- **User Dashboard**: View assigned QR codes
- **Database Storage**: All QR codes are stored in MongoDB
- **Unique QR Values**: 16-digit unique identifiers for each QR code

### New Feature: Add Device with QR Scanner
- **QR Code Scanner**: Users can scan QR codes using their device camera
- **Device Assignment**: Scanned QR codes are automatically assigned to the user
- **Real-time Validation**: Validates 16-digit QR code format
- **Error Handling**: Comprehensive error messages for various scenarios

## API Endpoints

### QR Code Endpoints
- `POST /generate-qrcodes` - Generate new QR codes (Admin only)
- `GET /qrcodes` - Get all QR codes (Admin only)
- `GET /user-qrcodes` - Get QR codes for current user
- `POST /assign-qrcode` - Assign QR code to user (new endpoint)
- `PUT /qrcodes/:id` - Update QR code value
- `DELETE /qrcodes/:id` - Soft delete QR code

### Authentication Endpoints
- `POST /signup` - User registration
- `POST /login` - User login
- `POST /logout` - User logout
- `GET /user` - Get current user info
- `GET /check-role` - Check user role

## How to Use the Add Device Feature

### For Users:
1. **Navigate to User Dashboard**: Login as a user and go to the User Dashboard
2. **Access QR Codes Section**: Click on "QR Codes" in the sidebar
3. **Click "Add Device"**: You'll see an "Add Device" button in the QR Codes section
4. **Scan QR Code**: 
   - The camera will activate
   - Position the QR code within the scanner frame
   - The system will automatically detect and validate the QR code
5. **Device Assignment**: If successful, the QR code will be assigned to your account
6. **View Added Device**: The newly added device will appear in your QR codes list

### For Admins:
1. **Generate QR Codes**: Use the admin dashboard to generate QR codes
2. **Distribute QR Codes**: Send the generated QR codes to users via WhatsApp, Email, or any external channel
3. **Users Scan**: Users can then scan these QR codes using the Add Device feature

### QR Code Format:
- QR codes must contain exactly 16 digits
- Example: `1234567890123456`
- The system validates the format before assignment

### Error Handling:
- **Invalid Format**: Shows error if QR code doesn't match 16-digit format
- **Already Assigned**: Prevents duplicate assignments
- **Not Found**: Shows error if QR code doesn't exist in the system
- **Camera Access**: Handles camera permission issues gracefully

## Database Schema

### User Model
```javascript
{
  name: String,
  email: String,
  password: String (hashed),
  role: String (enum: ["admin", "user"])
}
```

### QR Code Model
```javascript
{
  qrValue: String (16-digit unique),
  createdBy: ObjectId (ref: users),
  createdAt: Date,
  isActive: Boolean
}
```

## Setup Instructions

1. **Install Dependencies**
   ```bash
   # Server dependencies
   cd server
   npm install

   # Client dependencies
   cd ../client
   npm install
   ```

2. **Environment Setup**
   Create a `.env` file in the server directory:
   ```
   MONGO_URI=your_mongodb_connection_string
   SESSION_SECRET=your_session_secret
   PORT=3001
   ```

3. **Start the Application**
   ```bash
   # Start server (from server directory)
   npm start

   # Start client (from client directory)
   npm run dev
   ```

## Usage

1. **Register/Login**: Create an account or login with existing credentials
2. **Admin Functions**: 
   - Navigate to Admin Dashboard
   - Generate QR codes by specifying count
   - Edit or delete existing QR codes
3. **User Functions**:
   - Navigate to User Dashboard
   - View all QR codes assigned to your account
   - Use "Add Device" button to scan and assign new QR codes
   - QR codes are automatically generated by admins

## Technology Stack

- **Frontend**: React, Material-UI, Vite
- **Backend**: Node.js, Express.js
- **Database**: MongoDB with Mongoose
- **Authentication**: Express-session with MongoDB store
- **QR Code Generation**: qrcode.react library
- **QR Code Scanning**: html5-qrcode library (new) 